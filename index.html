<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- SEO -->
    <meta name="description" content="Calculadora gratuita de rentabilidad de alquiler en Espa√±a. Calcula TIR, ROI, cashflow mensual, ITP, hipoteca y proyecci√≥n a√±o a a√±o de tu inversi√≥n inmobiliaria."/>
    <meta name="keywords" content="calculadora rentabilidad alquiler, inversi√≥n inmobiliaria espa√±a, calcular ROI piso, TIR inmobiliaria, cashflow alquiler, ITP vivienda"/>
    <meta name="author" content="Calculadora Inversi√≥n Inmobiliaria"/>

    <!-- Open Graph / WhatsApp / redes -->
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://pisorentable.org"/>
    <meta property="og:title" content="Calculadora de Inversi√≥n Inmobiliaria | Espa√±a"/>
    <meta property="og:description" content="Calcula GRATIS el cashflow, ROI y rentabilidad neta de tu inversi√≥n inmobiliaria en Espa√±a."/>
    <meta property="og:image" content="https://pisorentable.org/piso.png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:image:type" content="image/png"/>

    <!-- Twitter card -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="Calculadora de Inversi√≥n Inmobiliaria | Espa√±a"/>
    <meta name="twitter:description" content="Calcula GRATIS el cashflow, ROI y rentabilidad neta de tu inversi√≥n inmobiliaria en Espa√±a."/>
    <meta name="twitter:image" content="https://pisorentable.org/piso.png"/>

    <link rel="icon" type="image/png" href="https://pisorentable.org/piso.png"/>
    <title>Calculadora de Inversi√≥n Inmobiliaria | Rentabilidad Alquiler Espa√±a</title>

    <!-- Fonts: preconnect primero para reducir latencia, display=swap evita FOUT -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,400&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

    <link rel="stylesheet" href="style.css">

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5TG9V5WN');</script>
    <!-- End Google Tag Manager -->

    <!-- Librer√≠as (Chart.js una sola vez) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5TG9V5WN"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="bg-particles" id="particles"></div>
<div class="app-container">

    <header class="header">
        <div class="header-controls">
            <button class="dark-mode-toggle" id="darkModeToggle" title="Modo oscuro">üåô</button>
            <select id="langSelector">
                <option value="es">üá™üá∏ Espa√±ol</option>
                <option value="en">üá¨üáß English</option>
            </select>
        </div>
        <div class="header-content">
            <div class="header-badge" data-i18n="header_badge">Herramienta gratuita ¬∑ Espa√±a</div>
            <h1 data-i18n="calculadora_inversion">üè† Calculadora de Inversi√≥n Inmobiliaria</h1>
            <p data-i18n="analisis_completo">An√°lisis completo para inversi√≥n en alquiler ¬∑ TIR ¬∑ ROI ¬∑ Cashflow ¬∑ Proyecci√≥n a largo plazo</p>
        </div>
    </header>

    <main class="main-content">
        <div class="content-grid">

            <!-- Panel de Configuraci√≥n -->
            <div class="glass-card config-panel">
                <div class="card-header">
                    <div class="card-title"><span data-i18n="configuracion_inversion">‚öôÔ∏è Configuraci√≥n de Inversi√≥n</span></div>
                    <div class="card-subtitle"><span data-i18n="personaliza_parametros">Personaliza todos los par√°metros de tu an√°lisis</span></div>
                </div>
                <div class="card-body">
                    <div class="nav-tabs">
                        <button class="nav-tab active" data-tab="propiedad"><span data-i18n="propiedad">üè† Propiedad</span></button>
                        <button class="nav-tab" data-tab="financiacion"><span data-i18n="financiacion">üí∞ Financiaci√≥n</span></button>
                        <button class="nav-tab" data-tab="ingresos"><span data-i18n="ingresos">üìà Ingresos</span></button>
                        <button class="nav-tab" data-tab="gastos"><span data-i18n="gastos">üìä Gastos</span></button>
                        <button class="nav-tab" data-tab="revalorizacion"><span data-i18n="revalorizacion">üíé Revalorizaci√≥n</span></button>
                        <button class="nav-tab" data-tab="turistico"><span>üèñÔ∏è Tur√≠stico</span></button>
                    </div>

                    <!-- Tab: Propiedad -->
                    <div class="tab-content active" id="propiedad-tab">
                        <div class="form-group">
                            <label class="form-label" data-i18n="precio_compra">Precio de compra</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="precio" min="0" step="1000" type="number" inputmode="decimal" value="95000"/>
                                <span class="input-suffix">‚Ç¨</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="tipo_vivienda">Tipo de vivienda
                                <span class="help-tooltip" title="El ITP var√≠a por regi√≥n. Selecciona la tuya para aplicar el tipo correcto autom√°ticamente.">‚ÑπÔ∏è</span>
                            </label>
                            <select class="form-select" id="tipoVivienda">
                                <option value="segunda" data-i18n="segunda_vivienda">Segunda vivienda (7% ITP)</option>
                                <option value="nueva" data-i18n="vivienda_nueva">Vivienda nueva (10% IVA + 1.2% AJD)</option>
                            </select>
                        </div>
                        <div class="form-group" id="ccaaGroup">
                            <label class="form-label" data-i18n="comunidad_autonoma">
                                Comunidad Aut√≥noma
                                <span class="help-tooltip" title="El ITP var√≠a por regi√≥n. Selecciona la tuya para aplicar el tipo correcto autom√°ticamente.">‚ÑπÔ∏è</span>
                            </label>
                            <select class="form-select" id="ccaaSelector">
                                <option value="" data-i18n="ccaa_selecciona">‚Äî Selecciona para ajustar el ITP ‚Äî</option>
                                <option value="6">Madrid (6%)</option>
                                <option value="7">Andaluc√≠a (7%)</option>
                                <option value="7">Arag√≥n (7%)</option>
                                <option value="7">Asturias (7%)</option>
                                <option value="7">Baleares (7%)</option>
                                <option value="6.5">Canarias (6.5%)</option>
                                <option value="6">Cantabria (6%)</option>
                                <option value="9">Castilla-La Mancha (9%)</option>
                                <option value="8">Castilla y Le√≥n (8%)</option>
                                <option value="10">Catalu√±a (10%)</option>
                                <option value="8">Extremadura (8%)</option>
                                <option value="10">Galicia (10%)</option>
                                <option value="6">La Rioja (6%)</option>
                                <option value="6">Navarra (6%)</option>
                                <option value="10">C. Valenciana (10%)</option>
                                <option value="7">Pa√≠s Vasco (7%)</option>
                                <option value="7">Murcia (7%)</option>
                            </select>
                            <div class="field-hint" id="itpHint" data-i18n="itp_hint_default">El ITP se calcula autom√°ticamente seg√∫n el tipo de vivienda (7% por defecto)</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="gastos_compra">Gastos de compra-venta</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="gastosCompra" min="0" step="100" type="number" inputmode="decimal" value="3000"/>
                                <span class="input-suffix">‚Ç¨</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="gastos_reforma">Gastos de reforma</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="reforma" min="0" step="100" type="number" inputmode="decimal" value="4000"/>
                                <span class="input-suffix">‚Ç¨</span>
                            </div>
                        </div>

                        <!-- ‚îÄ‚îÄ BLOQUE REFERENCIA DE MERCADO ‚îÄ‚îÄ -->
                        <!-- ‚îÄ‚îÄ BLOQUE REFERENCIA DE MERCADO ‚îÄ‚îÄ -->
                        <div class="mercado-ref-block">
                            <div class="mercado-ref-header">
                                <span class="mercado-ref-icon">üìç</span>
                                <span class="mercado-ref-title">An√°lisis de mercado <span class="mercado-ref-badge">Opcional</span></span>
                            </div>

                            <!-- CP + superficie en la misma fila -->
                            <div class="mercado-row-inline">
                                <div class="form-group mercado-field" style="flex:1;">
                                    <label class="form-label">C√≥digo postal</label>
                                    <input class="form-input" id="codigoPostal" type="text" inputmode="numeric" maxlength="5" placeholder="41002" style="letter-spacing:0.12em;"/>
                                </div>
                                <div class="form-group mercado-field" style="flex:1;">
                                    <label class="form-label">Superficie</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="superficieM2" type="number" inputmode="decimal" min="0" step="1" placeholder="80"/>
                                        <span class="input-suffix">m¬≤</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Tarjeta de datos de mercado (se muestra al detectar provincia) -->
                            <div id="mercadoCard" class="mercado-card" style="display:none;">
                                <div class="mercado-card-provincia" id="mercadoCardProvincia">‚Äî</div>
                                <div class="mercado-card-precio">
                                    <div class="mercado-precio-item">
                                        <span class="mercado-precio-label">Precio medio ‚Ç¨/m¬≤</span>
                                        <strong class="mercado-precio-val" id="mercadoCardPrecioM2">‚Äî</strong>
                                    </div>
                                    <div class="mercado-precio-item mercado-precio-item--edit">
                                        <span class="mercado-precio-label">Ajustar (Idealista/Fotocasa)</span>
                                        <div class="input-group" style="max-width:140px;">
                                            <input class="form-input with-suffix" id="precioRefM2" type="number" inputmode="decimal" min="0" step="50" placeholder="auto"/>
                                            <span class="input-suffix" style="font-size:0.7rem;">‚Ç¨/m¬≤</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Panel de comparativa (se muestra con CP + superficie) -->
                            <div class="mercado-resultado" id="mercadoResultado" style="display:none;">
                                <div class="mercado-resultado-row">
                                    <span>Valor estimado de mercado</span>
                                    <strong id="mrValorMercado" class="metric-info">‚Äî</strong>
                                </div>
                                <div class="mercado-resultado-row mercado-resultado-row--vs">
                                    <span>Tu precio vs. mercado</span>
                                    <strong id="mrVsTexto">‚Äî</strong>
                                </div>
                                <div class="mercado-resultado-divider">üí° Estrategia de oferta</div>
                                <div class="mercado-resultado-row">
                                    <span>Descuento negociaci√≥n</span>
                                    <div class="mercado-descuento-wrap">
                                        <input type="number" id="descuentoOferta" class="mercado-descuento-input" min="0" max="30" step="0.5" value="10"/>
                                        <span class="mercado-descuento-pct">%</span>
                                    </div>
                                </div>
                                <div class="mercado-resultado-row mercado-resultado-row--oferta">
                                    <span>üí¨ Oferta inicial sugerida</span>
                                    <strong id="mrOferta" class="metric-positive">‚Äî</strong>
                                </div>
                                <div class="mercado-resultado-row mercado-resultado-row--ahorro">
                                    <span>Ahorro potencial si aceptan</span>
                                    <strong id="mrAhorro" class="metric-positive">‚Äî</strong>
                                </div>
                            </div>
                        </div>
                        <!-- ‚îÄ‚îÄ FIN BLOQUE REFERENCIA ‚îÄ‚îÄ -->

                    </div>

                    <!-- Tab: Financiaci√≥n -->
                    <div class="tab-content" id="financiacion-tab">
                        <div class="form-group">
                            <label class="form-label" data-i18n="tipo_financiacion">Tipo de financiaci√≥n</label>
                            <select class="form-select" id="financiacionTipo">
                                <option value="con_hipoteca" data-i18n="con_hipoteca">Con hipoteca</option>
                                <option value="sin_hipoteca" data-i18n="sin_hipoteca">Sin hipoteca</option>
                            </select>
                        </div>
                        <div class="form-group" id="entradaGroup">
                            <label class="form-label" data-i18n="ahorro_aportado">Ahorro aportado</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="entradaEuros" min="0" step="1000" type="number" inputmode="decimal" value="19000"/>
                                <span class="input-suffix" id="entradaPorcentajeDisplay">20%</span>
                            </div>
                            <div class="slider-container">
                                <input type="range" id="entradaSlider" class="form-slider" min="0" max="95000" step="1000" value="19000"/>
                            </div>
                        </div>
                        <div class="form-group" id="interesGroup">
                            <label class="form-label" data-i18n="interes_hipoteca">Tipo de inter√©s hipoteca</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="interes" max="15" min="0" step="0.1" type="number" inputmode="decimal" value="3.2"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>
                        <div class="form-group" id="anosGroup">
                            <label class="form-label" data-i18n="anos_hipoteca">A√±os de hipoteca</label>
                            <input class="form-input" id="anos" max="40" min="5" step="1" type="number" inputmode="decimal" value="25"/>
                        </div>
                        <div class="form-group" id="gastosHipGroup">
                            <label class="form-label" data-i18n="gastos_hipoteca">Gastos de hipoteca</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="gastosHipoteca" min="0" step="100" type="number" inputmode="decimal" value="1800"/>
                                <span class="input-suffix">‚Ç¨</span>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Ingresos -->
                    <div class="tab-content" id="ingresos-tab">
                        <div class="form-group">
                            <label class="form-label" data-i18n="alquiler_mensual">Alquiler mensual</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="alquiler" min="0" step="50" type="number" inputmode="decimal" value="700"/>
                                <span class="input-suffix" data-i18n="mes">‚Ç¨/mes</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="meses_vacios">Meses vac√≠o al a√±o</label>
                            <input class="form-input" id="mesesVacio" max="12" min="0" step="0.5" type="number" inputmode="decimal" value="0.5"/>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="incremento_alquiler">Incremento anual del alquiler</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="incrementoAlquiler" max="10" min="0" step="0.1" type="number" inputmode="decimal" value="2"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="anos_analisis">A√±os de an√°lisis</label>
                            <input class="form-input" id="anosAnalisis" max="40" min="1" step="1" type="number" inputmode="decimal" value="20"/>
                        </div>
                    </div>

                    <!-- Tab: Gastos -->
                    <div class="tab-content" id="gastos-tab">
                        <div class="form-group">
                            <label class="form-label" data-i18n="ibi_anual">IBI anual</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="ibi" min="0" step="50" type="number" inputmode="decimal" value="380"/>
                                <span class="input-suffix" data-i18n="ano">‚Ç¨/a√±o</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="gastos_comunidad">Gastos de comunidad</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="comunidad" min="0" step="10" type="number" inputmode="decimal" value="55"/>
                                <span class="input-suffix" data-i18n="mes">‚Ç¨/mes</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="seguro_hogar">Seguro de hogar</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="seguro" min="0" step="50" type="number" inputmode="decimal" value="220"/>
                                <span class="input-suffix" data-i18n="ano">‚Ç¨/a√±o</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="seguro_impago">Seguro de impago</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="seguroImpago" min="0" step="50" type="number" inputmode="decimal" value="160"/>
                                <span class="input-suffix" data-i18n="ano">‚Ç¨/a√±o</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="mantenimiento">Mantenimiento y reparaciones</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="mantenimiento" min="0" step="50" type="number" inputmode="decimal" value="400"/>
                                <span class="input-suffix" data-i18n="ano">‚Ç¨/a√±o</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="administracion">Administraci√≥n/Gesti√≥n</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="administracion" min="0" step="10" type="number" inputmode="decimal" value="0"/>
                                <span class="input-suffix" data-i18n="mes">‚Ç¨/mes</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="incremento_gastos">Incremento anual de gastos</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="incrementoGastos" max="10" min="0" step="0.1" type="number" inputmode="decimal" value="0"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="tasa_impositiva">
                                Tasa impositiva sobre alquiler neto
                                <span class="help-tooltip" title="Modelo fiscal simplificado. La fiscalidad real depende de tu tramo IRPF, la reducci√≥n del 60% por alquiler de vivienda habitual y tus deducciones reales (intereses, amortizaci√≥n). Consulta con un asesor fiscal.">‚ÑπÔ∏è</span>
                            </label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="taxAlquiler" max="47" min="0" step="0.1" type="number" inputmode="decimal" value="19"/>
                                <span class="input-suffix">%</span>
                            </div>
                            <div class="field-hint">Tipo orientativo. Tramos reales IRPF: 19% (&lt;6.000‚Ç¨), 21% (6-50k‚Ç¨), 23% (50-200k‚Ç¨), 26% (&gt;200k‚Ç¨). Reduce el 60% si es vivienda habitual.</div>
                        </div>
                    </div>

                    <!-- Tab: Revalorizaci√≥n -->
                    <div class="tab-content" id="revalorizacion-tab">
                        <div class="form-group">
                            <label class="form-label" data-i18n="revalorizacion_anual">
                                Revalorizaci√≥n anual del inmueble
                                <span class="help-tooltip" title="Asunci√≥n de crecimiento constante anual. El mercado real no es lineal: incluye ca√≠das y subidas bruscas. Usa este campo para comparar escenarios, no como predicci√≥n.">‚ÑπÔ∏è</span>
                            </label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="revalorizacion" max="15" min="-5" step="0.1" type="number" inputmode="decimal" value="3.5"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="gastos_venta">Gastos de venta futura</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="gastosVenta" max="15" min="0" step="0.1" type="number" inputmode="decimal" value="8"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="plusvalia">Impuesto plusval√≠a municipal</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="plusvalia" min="0" step="100" type="number" inputmode="decimal" value="2000"/>
                                <span class="input-suffix">‚Ç¨</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="irpf_venta">IRPF por venta (19-23%)</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="irpfVenta" max="47" min="0" step="0.1" type="number" inputmode="decimal" value="19"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>

                        <!-- Escenarios -->
                        <div class="scenario-section">
                            <div class="scenario-label" data-i18n="escenarios_label">‚ö° Escenarios r√°pidos</div>
                            <div class="scenario-buttons">
                                <button class="btn-scenario" data-i18n="escenario_pesimista" onclick="aplicarEscenario('pesimista')">üòü Pesimista</button>
                                <button class="btn-scenario active" data-i18n="escenario_realista" onclick="aplicarEscenario('realista')">üòê Realista</button>
                                <button class="btn-scenario" data-i18n="escenario_optimista" onclick="aplicarEscenario('optimista')">üöÄ Optimista</button>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Tur√≠stico -->
                    <div class="tab-content" id="turistico-tab">
                        <div class="turistico-header">
                            <span class="turistico-badge">üèñÔ∏è Alquiler Tur√≠stico</span>
                            <p class="turistico-desc">Compara larga duraci√≥n vs. alquiler vacacional para maximizar ingresos.</p>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Precio por noche</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="precioNoche" min="0" step="5" type="number" inputmode="decimal" value="85"/>
                                <span class="input-suffix">‚Ç¨/noche</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                Ocupaci√≥n media anual
                                <span class="help-tooltip" title="% de noches ocupadas al a√±o. Media Espa√±a tur√≠stico: 60-75%. Zonas premium (Costa del Sol, Barcelona, Madrid centro): 70-85%.">‚ÑπÔ∏è</span>
                            </label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="ocupacionTuristico" min="0" max="100" step="1" type="number" inputmode="decimal" value="65"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gastos plataforma (Airbnb/Booking)</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="comisionPlataforma" min="0" max="30" step="0.5" type="number" inputmode="decimal" value="15"/>
                                <span class="input-suffix">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gastos limpieza / rotaci√≥n</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="gastosLimpieza" min="0" step="50" type="number" inputmode="decimal" value="1200"/>
                                <span class="input-suffix">‚Ç¨/a√±o</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Suministros (luz, agua, wifi)</label>
                            <div class="input-group">
                                <input class="form-input with-suffix" id="suministrosTuristico" min="0" step="50" type="number" inputmode="decimal" value="1800"/>
                                <span class="input-suffix">‚Ç¨/a√±o</span>
                            </div>
                        </div>
                        <div id="turisticoResultado" class="turistico-resultado" style="display:none;"></div>
                        <button class="btn btn-primary" id="calcTuristicoBtn" style="width:100%; margin-top:0.5rem;">üèñÔ∏è Calcular y Comparar</button>
                    </div>

                    <!-- Botones de acci√≥n -->
                    <div class="action-buttons" style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                        <button class="btn btn-reset" id="resetBtn" title="Restablecer valores por defecto">üîÑ</button>
                        <button class="btn btn-share" id="shareBtn"><span data-i18n="btn_compartir">üîó Compartir</span></button>
                        <button class="btn btn-whatsapp" id="whatsappBtn" title="Compartir por WhatsApp">üì± WhatsApp</button>
                        <button class="btn btn-save" id="saveBtn" title="Guardar este an√°lisis">üíæ Guardar</button>
                        <button class="btn btn-compare" id="compareBtn" title="Comparar dos inmuebles">‚öñÔ∏è Comparar</button>
                        <button class="btn btn-widget" id="widgetBtn" title="Obtener c√≥digo widget">üîå Widget</button>
                        <button class="btn btn-tools" id="toolsBtn" title="Herramientas adicionales">üõ†Ô∏è Herramientas</button>
                        <button class="btn btn-primary" id="pdfBtn" style="background: var(--gradient-main);"><span data-i18n="btn_exportar_pdf">üìÑ PDF</span></button>
                        <button class="btn btn-primary btn-block" id="calcularBtn" style="flex: 1 1 auto;"><span data-i18n="analizar_inversion">üßÆ Analizar</span></button>
                    </div>

                    <!-- Notificaci√≥n de enlace copiado -->
                    <div class="share-toast" id="shareToast" data-i18n="share_toast">‚úÖ Enlace copiado al portapapeles</div>
                </div>
            </div>

            <!-- Panel de Resultados -->
            <div class="glass-card results-panel">
                <div class="card-header">
                    <div class="card-title"><span data-i18n="analisis_rentabilidad">üìä An√°lisis de Rentabilidad</span></div>
                    <div class="card-subtitle"><span data-i18n="resultados_completos">Resultados completos de tu inversi√≥n a largo plazo</span></div>
                </div>
                <div class="card-body">
                    <div id="resultados">
                        <div class="empty-state">
                            <div class="empty-state-icon">üìà</div>
                            <h3 data-i18n="analiza_inversion">¬°Analiza tu inversi√≥n inmobiliaria!</h3>
                            <p data-i18n="completa_datos">Completa los datos en el panel izquierdo y haz clic en "Analizar Inversi√≥n" para obtener un an√°lisis detallado de rentabilidad con proyecci√≥n a largo plazo.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Secci√≥n SEO ‚Äî contenido sem√°ntico indexable -->
        <section class="seo-section" aria-label="Gu√≠a de inversi√≥n inmobiliaria">

            <!-- Bloque intro + gu√≠a m√©tricas -->
            <div class="seo-intro">
                <h2>C√≥mo calcular la rentabilidad de un piso en alquiler en Espa√±a</h2>
                <p>Invertir en vivienda para alquilar es una de las decisiones financieras m√°s importantes que puedes tomar. Esta calculadora gratuita te ayuda a analizar todos los factores que determinan si una inversi√≥n inmobiliaria es rentable: desde el precio de compra y los impuestos hasta el cashflow mensual, la TIR y el valor neto al vender tras a√±os de alquiler.</p>
                <p>A diferencia de otras calculadoras b√°sicas, aqu√≠ puedes modelar la hipoteca real con amortizaci√≥n, el ITP seg√∫n tu comunidad aut√≥noma, los gastos operativos anuales, la fiscalidad sobre rentas del alquiler y la revalorizaci√≥n del inmueble a lo largo del tiempo. El resultado es una proyecci√≥n a√±o a a√±o que te permite comparar tu inversi√≥n con alternativas como dep√≥sitos, bonos o el S&P 500.</p>
            </div>

            <!-- Gu√≠a de m√©tricas con microcopy -->
            <div class="seo-metrics-guide">
                <h2>Qu√© m√©trica mirar seg√∫n tu objetivo inversor</h2>
                <p>La calculadora genera varios indicadores. Aqu√≠ te explicamos cu√°ndo priorizar cada uno:</p>
                <div class="seo-grid">
                    <div class="seo-card">
                        <div class="seo-icon">üíß</div>
                        <h3>Cashflow mensual neto</h3>
                        <p>Lo que te queda en el bolsillo cada mes despu√©s de pagar hipoteca, gastos e impuestos. <strong>Si buscas vivir del alquiler o complementar ingresos hoy, este es tu n√∫mero clave.</strong> Un cashflow positivo desde el primer a√±o da tranquilidad financiera. Negativo no significa mala inversi√≥n, pero implica que necesitar√°s aportaciones mensuales.</p>
                        <div class="metric-guide-tag">üëâ Ideal para: renta pasiva mensual</div>
                    </div>
                    <div class="seo-card">
                        <div class="seo-icon">‚ö°</div>
                        <h3>Rentabilidad anual compuesta (TIR estimada)</h3>
                        <p>Mide el rendimiento total de tu dinero teniendo en cuenta tanto los alquileres cobrados como la ganancia por venta futura. <strong>Si inviertes a largo plazo y priorizas el patrimonio final, este indicador lo resume todo.</strong> Una TIR superior al 6-7% supera hist√≥ricamente al mercado inmobiliario espa√±ol medio.</p>
                        <div class="metric-guide-tag">üëâ Ideal para: acumulaci√≥n de patrimonio</div>
                    </div>
                    <div class="seo-card">
                        <div class="seo-icon">üìä</div>
                        <h3>ROI anual sobre capital invertido</h3>
                        <p>Relaciona el cashflow anual con el capital que pusiste de tu bolsillo (entrada + impuestos + gastos). <strong>Un ROI alto con cashflow negativo es se√±al de alerta: significa que el n√∫mero queda bien sobre el papel pero que cada mes necesitas aportar dinero.</strong> Valora siempre ambos juntos.</p>
                        <div class="metric-guide-tag">üëâ Ojo: ROI alto + cashflow negativo = riesgo de liquidez</div>
                    </div>
                    <div class="seo-card">
                        <div class="seo-icon">üè†</div>
                        <h3>Valor neto al vender</h3>
                        <p>Lo que recibir√≠as si vendieras el inmueble al final del per√≠odo de an√°lisis, descontando gastos de venta, plusval√≠a municipal e IRPF sobre la ganancia de capital. <strong>Si tu estrategia es comprar, alquilar y vender en 10-15 a√±os, esta cifra m√°s el flujo acumulado define tu beneficio real total.</strong></p>
                        <div class="metric-guide-tag">üëâ Ideal para: estrategia buy-to-let a plazo fijo</div>
                    </div>
                </div>
            </div>

            <!-- Art√≠culo largo con keywords -->
            <div class="seo-article">
                <h2>Errores comunes al calcular el ROI de un piso en alquiler</h2>

                <h3>1. Ignorar los meses sin inquilino</h3>
                <p>La mayor√≠a de calculadoras asumen 12 meses de alquiler al a√±o. En la pr√°ctica, entre rotaciones de inquilinos, reformas entre contratos y per√≠odos de b√∫squeda, lo habitual en Espa√±a es perder entre 3 y 6 semanas al a√±o. Esta calculadora te permite configurar los meses vac√≠os exactos para obtener un resultado realista. Un inmueble con 1 mes de vac√≠o al a√±o pierde un 8,3% de sus ingresos brutos.</p>

                <h3>2. Olvidar los gastos que no se ven</h3>
                <p>El IBI, los gastos de comunidad, el seguro de hogar, el seguro de impago, el mantenimiento y la gesti√≥n si tienes agencia: todos estos gastos pueden sumar f√°cilmente entre 2.000 y 4.000 euros al a√±o en un piso de precio medio. Ignorarlos puede hacer que un piso que parece rentable en papel d√© p√©rdidas reales.</p>

                <h3>3. No tener en cuenta la fiscalidad</h3>
                <p>Los rendimientos de capital inmobiliario tributan en el IRPF. La legislaci√≥n espa√±ola permite deducir los intereses de la hipoteca, el IBI, la comunidad, los seguros y la amortizaci√≥n del inmueble (generalmente el 3% del valor de construcci√≥n). Esta calculadora aplica un modelo fiscal simplificado sobre el alquiler neto. <em>No sustituye un c√°lculo IRPF real con todas tus deducciones personales.</em> Para una planificaci√≥n fiscal precisa, consulta con un asesor.</p>

                <h3>4. Asumir revalorizaci√≥n constante</h3>
                <p>El modelo de esta calculadora asume un crecimiento anual constante del precio del inmueble. En la realidad, el mercado inmobiliario en Espa√±a ha mostrado per√≠odos de ca√≠das (2008-2014), estancamiento y fuertes subidas (2015-2024). La revalorizaci√≥n constante es una simplificaci√≥n √∫til para comparar escenarios, no una predicci√≥n. √ösala para ver el rango de resultados, no como certeza.</p>

                <h3>5. Confundir rentabilidad bruta con rentabilidad neta</h3>
                <p>La <strong>rentabilidad bruta</strong> es simplemente alquiler anual dividido entre precio de compra. La <strong>rentabilidad neta</strong> descuenta todos los gastos. En Espa√±a, una rentabilidad bruta del 6% puede convertirse en una neta del 3-4% al incluir todos los costes. Esta calculadora trabaja siempre con rentabilidad neta real, que es el √∫nico dato que importa para tomar decisiones.</p>

                <h3>¬øQu√© es un buen cashflow inmobiliario en Espa√±a?</h3>
                <p>En el mercado espa√±ol actual, con precios elevados en las principales ciudades, conseguir un cashflow positivo con hipoteca es cada vez m√°s dif√≠cil en Madrid, Barcelona o Valencia. Lo habitual es cashflow ligeramente negativo o cercano a cero en grandes urbes, apostando por revalorizaci√≥n, y cashflows positivos m√°s claros en ciudades medianas o zonas de playa con alta demanda tur√≠stica. Un cashflow de +200 a +400 ‚Ç¨/mes se considera un resultado muy bueno en el contexto actual de tipos de inter√©s.</p>
            </div>

            <!-- Aviso legal expl√≠cito -->
            <div class="seo-disclaimer-box">
                <span class="seo-disclaimer-icon">‚öñÔ∏è</span>
                <div>
                    <strong>Modelo fiscal simplificado.</strong> Esta herramienta aplica una tasa impositiva fija sobre el alquiler neto. La fiscalidad real del alquiler en Espa√±a depende de tu tramo de IRPF, las deducciones aplicables (intereses, amortizaci√≥n, gastos reales) y tu situaci√≥n personal. Los resultados son orientativos y no sustituyen el asesoramiento de un profesional fiscal. La rentabilidad anual compuesta mostrada es una estimaci√≥n basada en flujos de caja proyectados, no una TIR financiera auditada.
                </div>
            </div>

        </section>

        <!--
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        BLOQUE PUBLICITARIO ‚Äî Google AdSense
        Para activarlo cuando tengas cuenta aprobada:
        1. Sustituye ca-pub-XXXXXXXXXXXXXXXXX por tu Publisher ID
        2. Sustituye XXXXXXXXXX por tu Ad Unit ID
        3. Descomenta todo este bloque

        <div class="ad-banner-container">
            <div class="ad-label">Publicidad</div>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXXXXXXXXX"
                 data-ad-slot="XXXXXXXXXX"
                 data-ad-format="auto"
                 data-full-width-responsive="true">
            </ins>
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        -->

    </main>

    <!-- Resumen flotante (mobile) -->
    <div class="floating-summary" id="floatingSummary">
        <div class="floating-label" data-i18n="rentabilidad_flujo">Cashflow mensual</div>
        <div id="floatingValue" class="floating-value">-</div>
        <div class="floating-tir" id="floatingTir"></div>
    </div>

    <footer class="legal-info">
        <p><a href="privacidad.html" target="_blank" rel="noopener" style="color: #94a3b8; text-decoration: underline;">Aviso Legal y Privacidad</a></p>
        <a href="https://librecounter.org/referer/show" target="_blank" rel="noopener">
            <img src="https://librecounter.org/counter.svg" referrerPolicy="unsafe-url" alt="Contador de visitas" style="width:1px;height:1px;opacity:0;position:absolute;" />
        </a>
    </footer>
</div>

<div id="cookie-banner" class="cookie-banner">
    <p>
        üç™ Utilizamos cookies t√©cnicas para el funcionamiento de la calculadora. No recopilamos datos personales.
        <button onclick="aceptarCookies()" class="btn-cookie">Aceptar</button>
    </p>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     FOOTER ‚Äî Inv√≠tame a un caf√© ‚òï
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<footer class="site-footer">
    <div class="footer-inner">
        <p class="footer-text" data-i18n="footer_texto">
            Herramienta gratuita, hecha con ‚ù§Ô∏è para inversores como t√∫
        </p>
        <a class="btn-coffee"
           href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=boarding87%40gmail.com&currency_code=EUR"
           target="_blank"
           rel="noopener noreferrer">
            ‚òï <span data-i18n="footer_cafe">¬øTe ha sido √∫til? Inv√≠tame a un caf√©</span>
        </a>
        <p class="footer-disclaimer" data-i18n="footer_disclaimer">
            Esta herramienta es orientativa y no constituye asesoramiento financiero.
        </p>
    </div>
</footer>

<script src="app.js"></script>

    <!-- ‚îÄ‚îÄ MODAL: AN√ÅLISIS GUARDADOS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="modal-overlay" id="savedModal" onclick="if(event.target===this)closeSavedModal()">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">üíæ An√°lisis Guardados</span>
                <button class="modal-close" onclick="closeSavedModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="save-new-row">
                    <input type="text" id="saveNameInput" class="form-input" placeholder="Nombre del an√°lisis (ej: Piso Sevilla centro)" maxlength="60"/>
                    <button class="btn btn-primary" onclick="saveCurrentAnalysis()" style="white-space:nowrap; padding:0.75rem 1.25rem;">üíæ Guardar</button>
                </div>
                <div id="savedList" class="saved-list"></div>
            </div>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ MODAL: COMPARADOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="modal-overlay" id="compareModal" onclick="if(event.target===this)closeCompareModal()">
        <div class="modal-box modal-box--wide">
            <div class="modal-header">
                <span class="modal-title">‚öñÔ∏è Comparador de Inmuebles</span>
                <button class="modal-close" onclick="closeCompareModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <p class="modal-hint">Selecciona dos an√°lisis guardados para compararlos en detalle.</p>
                <div class="compare-selectors">
                    <div class="compare-selector">
                        <label class="form-label">Inmueble A</label>
                        <select id="compareSelectA" class="form-select"></select>
                    </div>
                    <div class="compare-vs">VS</div>
                    <div class="compare-selector">
                        <label class="form-label">Inmueble B</label>
                        <select id="compareSelectB" class="form-select"></select>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="runComparison()" style="width:100%; margin-top:1rem;">‚öñÔ∏è Comparar ahora</button>
                <div id="compareResult" class="compare-result"></div>
            </div>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ MODAL: HERRAMIENTAS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="modal-overlay" id="toolsModal" onclick="if(event.target===this)closeToolsModal()">
        <div class="modal-box modal-box--wide">
            <div class="modal-header">
                <span class="modal-title">üõ†Ô∏è Herramientas Adicionales</span>
                <button class="modal-close" onclick="closeToolsModal()">‚úï</button>
            </div>
            <div class="modal-body">

                <!-- HERRAMIENTA 1: ¬øCu√°nto puedo pagar? -->
                <div class="tool-section" id="tool-capacidad">
                    <div class="tool-section-header" onclick="toggleTool('capacidad')">
                        <span class="tool-icon">üè¶</span>
                        <div class="tool-info">
                            <span class="tool-title">¬øCu√°nto puedo pagar?</span>
                            <span class="tool-desc">Calcula el precio m√°ximo seg√∫n tus ingresos</span>
                        </div>
                        <span class="tool-chevron">‚ñæ</span>
                    </div>
                    <div class="tool-body" id="tool-body-capacidad">
                        <div class="tool-inner">
                            <div class="tools-row">
                                <div class="form-group">
                                    <label class="form-label">Sueldo neto mensual</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="sueldoNeto" type="number" min="0" step="100" value="2500" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Otros ingresos (pareja, etc.)</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="otrosIngresos" type="number" min="0" step="100" value="0" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Otras deudas mensuales</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="otrasDeudas" type="number" min="0" step="50" value="0" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ahorros disponibles (entrada)</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="ahorrosDisponibles" type="number" min="0" step="1000" value="40000" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨</span>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" style="width:100%;" onclick="calcularCapacidad()">üè¶ Calcular capacidad</button>
                            <div id="capacidadResultado" class="tool-resultado" style="display:none;"></div>
                        </div>
                    </div>
                </div>

                <!-- HERRAMIENTA 2: Historial de CPs -->
                <div class="tool-section" id="tool-historial">
                    <div class="tool-section-header" onclick="toggleTool('historial')">
                        <span class="tool-icon">üïê</span>
                        <div class="tool-info">
                            <span class="tool-title">Historial de zonas buscadas</span>
                            <span class="tool-desc">√öltimas b√∫squedas por c√≥digo postal</span>
                        </div>
                        <span class="tool-chevron">‚ñæ</span>
                    </div>
                    <div class="tool-body" id="tool-body-historial">
                        <div class="tool-inner">
                            <div id="historialList" class="historial-list"></div>
                            <button class="btn btn-share" style="width:100%; margin-top:0.5rem; font-size:0.8rem;" onclick="clearHistorial()">üóëÔ∏è Borrar historial</button>
                        </div>
                    </div>
                </div>

                <!-- HERRAMIENTA 3: Modo r√°pido ¬øMe sale la cuenta? -->
                <div class="tool-section" id="tool-rapido">
                    <div class="tool-section-header" onclick="toggleTool('rapido')">
                        <span class="tool-icon">‚ö°</span>
                        <div class="tool-info">
                            <span class="tool-title">¬øMe sale la cuenta? (modo r√°pido)</span>
                            <span class="tool-desc">4 datos, respuesta en 3 segundos</span>
                        </div>
                        <span class="tool-chevron">‚ñæ</span>
                    </div>
                    <div class="tool-body" id="tool-body-rapido">
                        <div class="tool-inner">
                            <div class="tools-row">
                                <div class="form-group">
                                    <label class="form-label">Precio del piso</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="rpPrecio" type="number" min="0" step="5000" value="120000" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Entrada disponible</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="rpEntrada" type="number" min="0" step="1000" value="30000" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Alquiler esperado</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="rpAlquiler" type="number" min="0" step="50" value="700" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">A√±os de an√°lisis</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="rpAnos" type="number" min="5" max="40" step="1" value="20" inputmode="decimal"/>
                                        <span class="input-suffix">a√±os</span>
                                    </div>
                                </div>
                            </div>
                            <div id="rapidoResultado" class="rapido-resultado"></div>
                        </div>
                    </div>
                </div>

                <!-- HERRAMIENTA 4: ROI de reforma -->
                <div class="tool-section" id="tool-reforma">
                    <div class="tool-section-header" onclick="toggleTool('reforma')">
                        <span class="tool-icon">üî®</span>
                        <div class="tool-info">
                            <span class="tool-title">ROI de reforma</span>
                            <span class="tool-desc">¬øCu√°nto mejora la rentabilidad reformando?</span>
                        </div>
                        <span class="tool-chevron">‚ñæ</span>
                    </div>
                    <div class="tool-body" id="tool-body-reforma">
                        <div class="tool-inner">
                            <div class="tools-row">
                                <div class="form-group">
                                    <label class="form-label">Coste de la reforma</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="refCoste" type="number" min="0" step="500" value="15000" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Alquiler actual (sin reforma)</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="refAlquilerAntes" type="number" min="0" step="50" value="650" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Alquiler esperado (con reforma)</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="refAlquilerDespues" type="number" min="0" step="50" value="800" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Plusval√≠a esperada por reforma</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="refPlusvalia" type="number" min="0" step="1000" value="20000" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨</span>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" style="width:100%;" onclick="calcularROIReforma()">üî® Calcular ROI reforma</button>
                            <div id="reformaResultado" class="tool-resultado" style="display:none;"></div>
                        </div>
                    </div>
                </div>

                <!-- HERRAMIENTA 5: Alerta Eur√≠bor variable -->
                <div class="tool-section" id="tool-euribor">
                    <div class="tool-section-header" onclick="toggleTool('euribor')">
                        <span class="tool-icon">üìä</span>
                        <div class="tool-info">
                            <span class="tool-title">Simulador Eur√≠bor (hipoteca variable)</span>
                            <span class="tool-desc">Cashflow seg√∫n Eur√≠bor actual y escenarios</span>
                        </div>
                        <span class="tool-chevron">‚ñæ</span>
                    </div>
                    <div class="tool-body" id="tool-body-euribor">
                        <div class="tool-inner">
                            <div class="tools-row">
                                <div class="form-group">
                                    <label class="form-label">Capital pendiente</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="eurCapital" type="number" min="0" step="1000" value="80000" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Diferencial del banco</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="eurDiferencial" type="number" min="0" step="0.05" value="0.75" inputmode="decimal"/>
                                        <span class="input-suffix">%</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">A√±os restantes</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="eurAnos" type="number" min="1" max="40" step="1" value="20" inputmode="decimal"/>
                                        <span class="input-suffix">a√±os</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Alquiler mensual</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="eurAlquiler" type="number" min="0" step="50" value="700" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Gastos fijos mensuales</label>
                                    <div class="input-group">
                                        <input class="form-input with-suffix" id="eurGastos" type="number" min="0" step="10" value="150" inputmode="decimal"/>
                                        <span class="input-suffix">‚Ç¨/mes</span>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" style="width:100%;" onclick="calcularEuribor()">üìä Simular escenarios Eur√≠bor</button>
                            <div id="euriborResultado" class="tool-resultado" style="display:none;"></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ MODAL: WIDGET EMBEBIBLE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="modal-overlay" id="widgetModal" onclick="if(event.target===this)closeWidgetModal()">
        <div class="modal-box modal-box--wide">
            <div class="modal-header">
                <span class="modal-title">üîå Widget Embebible</span>
                <button class="modal-close" onclick="closeWidgetModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <p class="modal-hint">Copia este c√≥digo en tu web o blog para incrustar la calculadora con tu branding.</p>
                <div class="widget-options">
                    <label class="form-label">Tama√±o</label>
                    <div class="widget-size-row">
                        <button class="widget-size-btn active" onclick="setWidgetSize('full')" id="ws-full">Completo</button>
                        <button class="widget-size-btn" onclick="setWidgetSize('compact')" id="ws-compact">Compacto (800px)</button>
                        <button class="widget-size-btn" onclick="setWidgetSize('mini')" id="ws-mini">Mini (480px)</button>
                    </div>
                </div>
                <div class="widget-preview-label">C√≥digo para copiar:</div>
                <div class="widget-code-wrap">
                    <pre id="widgetCode" class="widget-code"></pre>
                    <button class="widget-copy-btn" onclick="copyWidgetCode()">üìã Copiar</button>
                </div>
                <div class="widget-disclaimer">
                    ‚ÑπÔ∏è El widget carga la calculadora completa en un iframe. Puedes a√±adir <code>?lang=en</code> para ingl√©s. Uso libre con atribuci√≥n a pisorentable.org.
                </div>
            </div>
        </div>
    </div>

</body>
</html>
